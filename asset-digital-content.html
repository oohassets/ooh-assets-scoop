<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SCOOP | OOH Assets Contents</title>

  <!-- Add favicon -->
  <link rel="icon" type="image/x-icon" href="scoopicon_32x32.ico">
  
  <style>
    body {
      font-family: "Segoe UI", sans-serif;
      background: #f5f6fa;
      margin: 20px;
      color: #333;
    }

    h2 {
      text-align: center;
      margin-bottom: 20px;
      color: #222;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      background: #fff;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      border-radius: 12px;
      overflow: hidden;
    }

    thead {
      background: #007bff;
      color: #fff;
    }

    th, td {
      padding: 12px 16px;
      text-align: center;
      vertical-align: middle;
    }

    tbody tr:nth-child(even) {
      background: #f9f9f9;
    }

    tbody tr:hover {
      background: #eef6ff;
    }

    .artwork {
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }

    .artwork img,
    .artwork video {
      border-radius: 8px;
      box-shadow: 0 1px 4px rgba(0,0,0,0.2);
      object-fit: contain;
      background: #fff;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      max-width: 100%;
      height: auto;
    }

    .artwork:hover img,
    .artwork:hover video {
      transform: scale(1.05);
      box-shadow: 0 4px 16px rgba(0,0,0,0.3);
    }

    .mupi-row {
      display: flex;
      gap: 14px;
      justify-content: space-between;
      flex-wrap: wrap;
    }

    .mupi-row .artwork {
      flex: 1 1 calc(33% - 10px);
      min-width: 150px;
    }

    .artwork div {
      font-size: 14px;
      color: #333;
      margin-bottom: 6px;
      font-weight: normal;
    }

    @media (max-width: 768px) {
      th, td {
        padding: 8px;
        font-size: 14px;
      }

      .mupi-row .artwork {
        flex: 1 1 100%;
      }
    }
  </style>
</head>
<body>
  <h2>Digital OOH Assets Screens</h2>
  <table>
    <thead>
      <tr>
        <th>Circuit Name</th>
        <th>Screens</th>
      </tr>
    </thead>
    <tbody id="table-body">
      <!-- Content auto-generated from JSON -->
    </tbody>
  </table>

  <script>
    async function loadMediaContent() {
      const response = await fetch("https://oohassets.github.io/ooh-assets-scoop/mediacontent/mediacontent.json");
      const data = await response.json();

      const tbody = document.getElementById("table-body");
      const mupiCircuits = {};
      
      Object.keys(data).forEach(circuit => {
        if (circuit.toLowerCase().includes("mupi")) {
          mupiCircuits[circuit] = data[circuit];
          return;
        }

        const row = document.createElement("tr");
        const nameCell = document.createElement("td");
        nameCell.innerHTML = `${circuit}<br><small>Auto size</small>`;

        const mediaCell = document.createElement("td");
        mediaCell.className = "artwork";

        data[circuit].forEach(url => {
          const video = document.createElement("video");
          video.src = url;
          video.autoplay = true;
          video.muted = true;
          video.loop = true;
          video.playsInline = true;
          mediaCell.appendChild(video);
        });

        row.appendChild(nameCell);
        row.appendChild(mediaCell);
        tbody.appendChild(row);
      });

      if (Object.keys(mupiCircuits).length > 0) {
        const mupiRow = document.createElement("tr");
        const mupiCell = document.createElement("td");
        mupiCell.colSpan = 2;

        const mupiContainer = document.createElement("div");
        mupiContainer.className = "mupi-row";

        Object.keys(mupiCircuits).forEach(mupiName => {
          const mupiDiv = document.createElement("div");
          mupiDiv.className = "artwork";
          const label = document.createElement('div');
          label.textContent = mupiName;
          mupiDiv.appendChild(label);

          const video = document.createElement("video");
          video.muted = true;
          video.playsInline = true;
          mupiDiv.appendChild(video);

          const sources = mupiCircuits[mupiName];
          let currentIndex = 0;

          function playNext() {
            video.src = sources[currentIndex];
            video.play();
            video.onended = () => {
              currentIndex = (currentIndex + 1) % sources.length;
              playNext();
            };
          }
          playNext();

          mupiContainer.appendChild(mupiDiv);
        });

        mupiCell.appendChild(mupiContainer);
        mupiRow.appendChild(mupiCell);
        tbody.appendChild(mupiRow);
      }
    }

    function resizeArtworks() {
      const baseHeight = 150; // smaller height for Mupi
      document.querySelectorAll(".artwork").forEach(cell => {
        const videos = cell.querySelectorAll("video, img");
        videos.forEach(media => {
          media.style.height = baseHeight + "px";
          media.style.width = "auto";
        });
      });
    }

    window.addEventListener("load", async () => {
      await loadMediaContent();
      resizeArtworks();
    });
    window.addEventListener("resize", resizeArtworks);
  </script>
</body>
</html>
